program new;
var
  Test, Output: String;
  Fails: Integer;
begin
  for Test in FindFiles('Tests', ['simba']) do
  begin
    WriteLn('Testing: ' + ExtractFileName(Test));

    if RunScript(Test, ['--silent=true'], Output) = 0 then
      WriteLn('Passed')
    else
    begin
      WriteLn('Failed "' + Trim(Output) + '"');

      Inc(Fails);
    end;
  end;

  if (Fails > 0) then
    raise IntToStr(Fails) + ' failed tests';
end.
